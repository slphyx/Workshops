(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     87268,       1867]
NotebookOptionsPosition[     86942,       1851]
NotebookOutlinePosition[     87286,       1866]
CellTagsIndexPosition[     87243,       1863]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Column", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ParaDist", "[", 
        RowBox[{"initN", ",", "48", ",", "\[Mu]", ",", "\[Sigma]"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"DHAGraph", "[", 
        RowBox[{"xm", ",", "ym", ",", "a", ",", "ke"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ParaGraph", "[", 
        RowBox[{
        "initN", ",", "PMR", ",", "\[Mu]", ",", "\[Sigma]", ",", "48", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"KZRB", ",", "KZRE"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KZRE", "+", "1"}], ",", "KZTE"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KZTE", "+", "1"}], ",", "KZSE"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"xm", ",", "ym", ",", "a", ",", "ke"}], "}"}], ",", 
         "everyH", ",", "Ndrug", ",", 
         RowBox[{"{", 
          RowBox[{"\[Gamma]R", ",", "\[Gamma]T", ",", "\[Gamma]S"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"ec50R", ",", "ec50T", ",", "ec50S"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.0", ",", "0.0", ",", "0.0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"emaxR", ",", "emaxT", ",", "emaxS"}], "}"}], ",", "T", ",",
          "120"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Style", "[", 
    RowBox[{
    "\"\<Mahidol-Oxford Tropical Medicine Research Unit\>\"", ",", "Bold"}], 
    "]"}], ",", "Delimiter", ",", 
   RowBox[{"Style", "[", 
    RowBox[{
    "\"\<Saralamba S. et al. PNAS (2011) vol.108 no.1 397-402\>\"", ",", 
     "Small"}], "]"}], ",", "Delimiter", ",", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ctrl", ",", "1", ",", "\"\<\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "\[Rule]", "\"\<parasite distribution\>\""}], ",", 
       RowBox[{"2", "\[Rule]", "\"\<dose regimen\>\""}], ",", 
       RowBox[{"3", "\[Rule]", "\"\<DHA concentration\>\""}], ",", 
       RowBox[{"4", "\[Rule]", "\"\<kill zones\>\""}], ",", 
       RowBox[{"5", "\[Rule]", "\"\<killing effect\>\""}]}], "}"}], ",", 
     RowBox[{"ControlPlacement", "\[Rule]", "Top"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PaneSelector", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"1", "\[Rule]", " ", 
        RowBox[{"Column", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<Parasite distribution on admission\>\"", ",", "Bold"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           "\"\<initial number of parasites\>\"", ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"initN", ",", 
                RowBox[{"2.8", "*", 
                 RowBox[{"10", "^", "11"}]}], ",", "\"\<\>\""}], "}"}], ",", 
              RowBox[{"1.", "*", 
               RowBox[{"10", "^", "11"}]}], ",", 
              RowBox[{"10", "^", "12"}], ",", 
              RowBox[{"0.5", "*", 
               RowBox[{"10", "^", "11"}]}], ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           "\"\<parasite multiplication rate (/48 hours)\>\"", ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"PMR", ",", "7", ",", "\"\<\>\""}], "}"}], ",", "6", 
              ",", "32", ",", "1", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "\"\<mean age of parasite (hours)\>\"", ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Mu]", ",", "10", ",", "\"\<\>\""}], "}"}], ",", "1",
               ",", "48", ",", "1", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           "\"\<standard deviation of parasite ages (hours)\>\"", ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Sigma]", ",", "4", ",", "\"\<\>\""}], "}"}], ",", 
              "1", ",", "50", ",", "1", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}]}], "}"}], 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"2", "\[Rule]", " ", 
        RowBox[{"Column", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Dose regimen\>\"", ",", "Bold"}], "]"}], ",", 
           "\[IndentingNewLine]", "\"\<number of doses\>\"", ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Ndrug", ",", "7", ",", "\"\<\>\""}], "}"}], ",", "1", 
              ",", "24", ",", "1", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "\"\<dosing interval (hours)\>\"", ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"everyH", ",", "24", ",", "\"\<\>\""}], "}"}], ",", 
              "1", ",", "48", ",", "1", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}]}], "}"}], 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"3", "\[Rule]", " ", 
        RowBox[{"Column", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<DHA concentration profile (for each dose)\>\"", ",", 
             "Bold"}], "]"}], ",", "\[IndentingNewLine]", 
           "\"\<time at max concentration (hours)\>\"", ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"xm", ",", "2", ",", "\"\<\>\""}], "}"}], ",", "1", 
              ",", "20", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "\"\<max concentration (ng/ml)\>\"", ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ym", ",", "1000", ",", "\"\<\>\""}], "}"}], ",", 
              "0.5", ",", "2000.", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "\"\<elimination rate (/hours)\>\"", ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ke", ",", "0.5", ",", "\"\<\>\""}], "}"}], ",", 
              "0.001", ",", "10", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}]}], "}"}], 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"4", "\[Rule]", " ", 
        RowBox[{"Column", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Kill zones (sensitive ages) \>\"", ",", "Bold"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           "\"\<ring: begin kill zone (hours)\>\"", ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"KZRB", ",", "6", ",", "\"\<\>\""}], "}"}], ",", "1", 
              ",", "96", ",", "1", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "\"\<ring: end kill zone (hours)\>\"", ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"KZRE", ",", "26", ",", "\"\<\>\""}], "}"}], ",", 
              "KZRB", ",", "60", ",", "1", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           "\"\<trophozoite: end kill zone (hours)\>\"", ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"KZTE", ",", "38", ",", "\"\<\>\""}], "}"}], ",", 
              RowBox[{"KZRE", "+", "1"}], ",", "90", ",", "1", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "\"\<schizont: end kill zone (hours)\>\"", 
           ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"KZSE", ",", "44", ",", "\"\<\>\""}], "}"}], ",", 
              RowBox[{"KZTE", "+", "1"}], ",", "100", ",", "1", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}]}], "}"}], 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"5", "\[Rule]", " ", 
        RowBox[{"Column", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Killing effect parameters\>\"", ",", "Bold"}], "]"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Gamma]R", ",", "6.5"}], "}"}], ",", "0.5", ",", 
              "10", ",", "0.001", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}], ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Gamma]T", ",", "6.5"}], "}"}], ",", "0.5", ",", 
              "10", ",", "0.001", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}], ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Gamma]S", ",", "6.5"}], "}"}], ",", "0.5", ",", 
              "10", ",", "0.001", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "\"\<EC50 ring (ng/ml)\>\"", ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ec50R", ",", "20.5", ",", "\"\<\>\""}], "}"}], ",", 
              "0.001", ",", "100", ",", "0.001", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "\"\<EC50 trophozoites (ng/ml)\>\"", ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ec50T", ",", "20.5", ",", "\"\<\>\""}], "}"}], ",", 
              "0.001", ",", "100", ",", "0.001", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "\"\<EC50 schizont (ng/ml)\>\"", ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ec50S", ",", "20.5", ",", "\"\<\>\""}], "}"}], ",", 
              "0.001", ",", "100", ",", "0.001", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "\"\<ring: max efficacy (%)\>\"", ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"emaxR", ",", "99.99", ",", "\"\<\>\""}], "}"}], ",", 
              "50", ",", "99.999", ",", "0.001", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "\"\<trophozoite: max efficacy (%)\>\"", 
           ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"emaxT", ",", "99.99", ",", "\"\<\>\""}], "}"}], ",", 
              "50", ",", "99.999", ",", "0.001", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "\"\<schizont: max efficacy (%)\>\"", ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"emaxS", ",", "99.99", ",", "\"\<\>\""}], "}"}], ",", 
              "50", ",", "99.999", ",", "0.001", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "\"\<1/alpha\>\"", ",", 
           RowBox[{"Control", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"T", ",", "5.", ",", "\"\<\>\""}], "}"}], ",", "1.", 
              ",", "10.", ",", "0.001", ",", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "}"}]}]}], "}"}], 
         "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Dynamic", "[", "ctrl", "]"}]}], "\[IndentingNewLine]", "]"}], 
   ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ControlPlacement", "\[Rule]", "Left"}], ",", 
   RowBox[{"SynchronousInitialization", "\[Rule]", "False"}], ",", 
   RowBox[{"ContinuousAction", "\[Rule]", "False"}], ",", 
   RowBox[{"AutorunSequencing", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Initialization", "\[RuleDelayed]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"concentration", " ", "of", " ", "DHA"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"genpoints", "[", 
        RowBox[{"xm_", ",", "ym_", ",", "ke_", ",", "x_"}], "]"}], ":=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ym", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ym", "/", "xm"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"xm", "-", "x"}], ")"}]}]}], ",", 
            RowBox[{"x", "\[LessEqual]", " ", "xm"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ym", "*", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "ke"}], "*", 
               RowBox[{"(", 
                RowBox[{"x", "-", "xm"}], ")"}]}], "]"}]}], ",", 
            RowBox[{"x", ">", " ", "xm"}]}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "calculate", " ", "the", " ", "drug", " ", "concentration", " ", "and",
         " ", "drug", " ", "efficacy", " ", "of", " ", "each", " ", 
        "parasite", " ", "stage", 
        RowBox[{"(", 
         RowBox[{"Ring", ",", 
          RowBox[{"Trophozoite", " ", "and", " ", "Schizont"}]}], ")"}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ConcMod", "[", 
        RowBox[{
        "xm_", ",", "ym_", ",", "a_", ",", "ke_", ",", "everyH_Integer", ",", 
         "Ndrug_Integer", ",", "gamma_List", ",", "ec50_List", ",", 
         "emin_List", ",", "emax_List"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"j", "=", "0"}], ",", 
           RowBox[{"nd", "=", "1"}], ",", "dat", ",", "maxpoint", ",", 
           "part1", ",", "part2", ",", "fitke", ",", "modka", ",", "modke", 
           ",", "fn", ",", "x", ",", "endtime", ",", "t", ",", 
           RowBox[{"conc", "=", "0"}], ",", 
           RowBox[{"concls", "=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"TIMEMAX", "=", "1000"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "0"}], ",", 
            RowBox[{"i", "<", 
             RowBox[{"Ndrug", "*", "everyH"}]}], ",", 
            RowBox[{"i", "=", 
             RowBox[{"i", "+", "1"}]}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"j", "\[NotEqual]", "everyH"}], ",", 
               RowBox[{
                RowBox[{"conc", "=", 
                 RowBox[{
                  RowBox[{"genpoints", "[", 
                   RowBox[{"xm", ",", "ym", ",", "ke", ",", "x"}], "]"}], "/.", 
                  RowBox[{"x", "\[Rule]", "j"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"concls", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "conc", ",", 
                    RowBox[{"Eff", "[", 
                    RowBox[{"conc", ",", 
                    RowBox[{"gamma", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"ec50", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"emin", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"emax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Eff", "[", 
                    RowBox[{"conc", ",", 
                    RowBox[{"gamma", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"ec50", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"emin", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"emax", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Eff", "[", 
                    RowBox[{"conc", ",", 
                    RowBox[{"gamma", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"ec50", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"emin", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"emax", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}],
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"j", "\[Equal]", "everyH"}], "&&", 
                RowBox[{"nd", "<", "Ndrug"}]}], ",", 
               RowBox[{
                RowBox[{"nd", "=", 
                 RowBox[{"nd", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"conc", "=", 
                 RowBox[{
                  RowBox[{"conc", "+", 
                   RowBox[{"genpoints", "[", 
                    RowBox[{"xm", ",", "ym", ",", "ke", ",", "x"}], "]"}]}], "/.", 
                  RowBox[{"x", "\[Rule]", "j"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"concls", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "conc", ",", 
                    RowBox[{"Eff", "[", 
                    RowBox[{"conc", ",", 
                    RowBox[{"gamma", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"ec50", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"emin", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"emax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Eff", "[", 
                    RowBox[{"conc", ",", 
                    RowBox[{"gamma", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"ec50", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"emin", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"emax", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Eff", "[", 
                    RowBox[{"conc", ",", 
                    RowBox[{"gamma", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"ec50", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"emin", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"emax", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}],
                 ";", "\[IndentingNewLine]", 
                RowBox[{"j", "=", "0"}], ";"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"update", " ", "ndrug"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"j", "=", 
              RowBox[{"j", "+", "1"}]}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "=", 
              RowBox[{"Ndrug", "*", "everyH"}]}], ";", 
             RowBox[{"j", "=", "everyH"}]}], ",", 
            RowBox[{"i", "\[LessEqual]", "TIMEMAX"}], ",", 
            RowBox[{"i", "=", 
             RowBox[{"i", "+", "1"}]}], ",", 
            RowBox[{
             RowBox[{"conc", "=", 
              RowBox[{
               RowBox[{"genpoints", "[", 
                RowBox[{"xm", ",", "ym", ",", "ke", ",", "x"}], "]"}], "/.", 
               RowBox[{"x", "\[Rule]", "j"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"concls", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "conc", ",", 
                 RowBox[{"Eff", "[", 
                  RowBox[{"conc", ",", 
                   RowBox[{"gamma", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"ec50", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"emin", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"emax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"Eff", "[", 
                  RowBox[{"conc", ",", 
                   RowBox[{"gamma", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"ec50", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"emin", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"emax", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"Eff", "[", 
                  RowBox[{"conc", ",", 
                   RowBox[{"gamma", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{"ec50", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{"emin", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{"emax", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"j", "=", 
              RowBox[{"j", "+", "1"}]}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "concls"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "age", " ", "distribution", " ", "of", " ", "parasites", " ", "on", 
        " ", "admission"}], " ", "*)"}], 
      RowBox[{
       RowBox[{"DistributeN", "[", 
        RowBox[{"initN_", ",", "LC_Integer", ",", "mu_", ",", "sigma_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"distr", ",", "x"}], "}"}], ",", 
         RowBox[{
          RowBox[{"distr", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"PDF", "[", 
               RowBox[{
                RowBox[{"NormalDistribution", "[", 
                 RowBox[{"mu", ",", "sigma"}], "]"}], ",", "x"}], "]"}], "//",
               "N"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "1", ",", "LC"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"initN", "/", 
             RowBox[{"Total", "[", "distr", "]"}]}], ")"}], "*", 
           "distr"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "shift", " ", "the", " ", "list", " ", "of", " ", "number", " ", "to", 
        " ", "the", " ", "right", " ", "with", " ", "a", " ", 
        "multiplication", " ", "pmr"}], "*)"}], 
      RowBox[{
       RowBox[{"Shiftonehour", "[", 
        RowBox[{"ls_List", ",", "PMR_Integer"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "tmp", "}"}], ",", 
         RowBox[{
          RowBox[{"tmp", "=", "ls"}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"RotateRight", "[", "tmp", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"tmp", ",", 
             RowBox[{"1", "\[Rule]", 
              RowBox[{
               RowBox[{"tmp", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", "PMR"}]}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", "tmp"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Eff", "[", 
        RowBox[{
        "c_", ",", "gamma_", ",", "ec50_", ",", "emin_", ",", "emax_"}], 
        "]"}], ":=", 
       RowBox[{"emin", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"emax", "-", "emin"}], ")"}], "*", 
         RowBox[{
          RowBox[{"c", "^", "gamma"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", "^", "gamma"}], "+", 
            RowBox[{"ec50", "^", "gamma"}]}], ")"}]}]}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Ki", "[", 
        RowBox[{"T_Real", ",", "concls_List"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "lsk"}], "}"}], ",", 
         RowBox[{
          RowBox[{"lsk", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"1", "/", "T"}], " ", 
                RowBox[{"Log", "[", 
                 RowBox[{"100.", "/", 
                  RowBox[{"(", 
                   RowBox[{"100.", "-", 
                    RowBox[{"concls", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ")"}]}], "]"}]}],
                ",", 
               RowBox[{
                RowBox[{"1", "/", "T"}], " ", 
                RowBox[{"Log", "[", 
                 RowBox[{"100.", "/", 
                  RowBox[{"(", 
                   RowBox[{"100.", "-", 
                    RowBox[{"concls", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "4"}], "]"}], "]"}]}], ")"}]}], "]"}]}],
                ",", 
               RowBox[{
                RowBox[{"1", "/", "T"}], " ", 
                RowBox[{"Log", "[", 
                 RowBox[{"100.", "/", 
                  RowBox[{"(", 
                   RowBox[{"100.", "-", 
                    RowBox[{"concls", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "5"}], "]"}], "]"}]}], ")"}]}], 
                 "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "concls", "]"}]}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", "lsk"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"decay", " ", "function"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Fdecay", "[", 
        RowBox[{
        "ages_", ",", "lst_", ",", "attime_", ",", "lsk_", ",", "stages_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tmp", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"i", "=", "ages"}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmp", "=", 
           RowBox[{"lst", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"stages", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], ",", 
            RowBox[{"tmp", "=", 
             RowBox[{
              RowBox[{"lst", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"lsk", "[", 
                 RowBox[{"[", 
                  RowBox[{"attime", ",", "1"}], "]"}], "]"}]}], "]"}]}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"stages", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "2"}], ",", 
            RowBox[{"tmp", "=", 
             RowBox[{
              RowBox[{"lst", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"lsk", "[", 
                 RowBox[{"[", 
                  RowBox[{"attime", ",", "2"}], "]"}], "]"}]}], "]"}]}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"stages", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "3"}], ",", 
            RowBox[{"tmp", "=", 
             RowBox[{
              RowBox[{"lst", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"lsk", "[", 
                 RowBox[{"[", 
                  RowBox[{"attime", ",", "3"}], "]"}], "]"}]}], "]"}]}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", "tmp"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"WhichRTS", "[", 
        RowBox[{"lst_List", ",", "KZ_List"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "tmp"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tmp", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"Length", "[", "lst", "]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "\[LessEqual]", 
             RowBox[{"Length", "[", "lst", "]"}]}], ",", 
            RowBox[{"i", "=", 
             RowBox[{"i", "+", "1"}]}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"IntervalMemberQ", "[", 
                 RowBox[{
                  RowBox[{"Interval", "[", 
                   RowBox[{"KZ", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "i"}], "]"}], 
                "\[Equal]", "True"}], ",", 
               RowBox[{
                RowBox[{"tmp", "=", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{"tmp", ",", 
                   RowBox[{"i", "\[Rule]", "1"}]}], "]"}]}], ";"}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"IntervalMemberQ", "[", 
                 RowBox[{
                  RowBox[{"Interval", "[", 
                   RowBox[{"KZ", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "i"}], "]"}], 
                "\[Equal]", "True"}], ",", 
               RowBox[{
                RowBox[{"tmp", "=", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{"tmp", ",", 
                   RowBox[{"i", "\[Rule]", "2"}]}], "]"}]}], ";"}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"IntervalMemberQ", "[", 
                 RowBox[{
                  RowBox[{"Interval", "[", 
                   RowBox[{"KZ", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "i"}], "]"}], 
                "\[Equal]", "True"}], ",", 
               RowBox[{
                RowBox[{"tmp", "=", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{"tmp", ",", 
                   RowBox[{"i", "\[Rule]", "3"}]}], "]"}]}], ";"}]}], "]"}], 
             ";"}]}], "]"}], ";", "\[IndentingNewLine]", "tmp"}]}], "]"}]}], 
      ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"sequestration", " ", "function"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PRingFunc", "[", 
        RowBox[{"i_Integer", ",", "a1_Integer", ",", "a2_Integer"}], "]"}], ":=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"i", "<", "a1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"Log", "[", "0.5", "]"}], "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "-", "a1"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"a2", "-", "a1"}], ")"}]}]}], "]"}], ",", 
            RowBox[{"i", "\[GreaterEqual]", "a1"}]}], "}"}]}], "}"}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LsDot", "[", 
        RowBox[{"ls1_List", ",", "ls2_List"}], "]"}], ":=", 
       RowBox[{"ls1", "*", "ls2"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ParasiteDynamics", "[", 
        RowBox[{
        "initN_", ",", "PMR_Integer", ",", "mu_", ",", "sigma_", ",", 
         "hours_Integer", ",", "KZ_List", ",", "concdat_List", ",", 
         "everyH_Integer", ",", "Ndrug_Integer", ",", "gamma_List", ",", 
         "ec50_List", ",", "emin_List", ",", "emax_List", ",", "T_Real", ",", 
         "runMax_Integer"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"runs", "=", "True"}], ",", "stages", ",", "concls", ",", 
           "i", ",", "j", ",", "lst", ",", "lsk", ",", 
           RowBox[{"output", "=", 
            RowBox[{"{", "}"}]}], ",", "xm", ",", "ym", ",", "a", ",", "ke", 
           ",", "junk", ",", "onlyring", ",", "tot"}], "}"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "template", " ", "of", " ", "the", " ", "drug", " ", "and", " ", 
           "its", " ", "effects"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xm", "=", 
           RowBox[{"concdat", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ym", "=", 
           RowBox[{"concdat", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"a", "=", 
           RowBox[{"concdat", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ke", "=", 
           RowBox[{"concdat", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"concls", "=", 
           RowBox[{"ConcMod", "[", 
            RowBox[{
            "xm", ",", "ym", ",", "a", ",", "ke", ",", "everyH", ",", "Ndrug",
              ",", "gamma", ",", "ec50", ",", "emin", ",", "emax"}], "]"}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"k_i", " ", 
            RowBox[{"(", "t", ")"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"lsk", "=", 
           RowBox[{"Ki", "[", 
            RowBox[{"T", ",", "concls"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"initial", " ", "parasite", " ", "load"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"lst", "=", 
           RowBox[{"DistributeN", "[", 
            RowBox[{"initN", ",", "hours", ",", "mu", ",", "sigma"}], "]"}]}],
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"stages", "=", 
           RowBox[{"WhichRTS", "[", 
            RowBox[{"lst", ",", "KZ"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"output", ",", "lst"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"runs", "\[Equal]", "True"}], "&&", 
             RowBox[{"i", "<", "runMax"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"i", "=", 
              RowBox[{"i", "+", "1"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Parasites", " ", "are", " ", 
               RowBox[{"growing", ".", "Feed"}], " ", 
               RowBox[{"them", "!"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"lst", "=", 
              RowBox[{"Shiftonehour", "[", 
               RowBox[{"lst", ",", "PMR"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"a", " ", "time", " ", "to", " ", 
               RowBox[{"kill", "."}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", "1"}], ",", 
               RowBox[{"j", "\[LessEqual]", 
                RowBox[{"Length", "[", "lst", "]"}]}], ",", 
               RowBox[{"j", "=", 
                RowBox[{"j", "+", "1"}]}], ",", 
               RowBox[{
                RowBox[{"lst", "=", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{"lst", ",", 
                   RowBox[{"j", "\[Rule]", 
                    RowBox[{"Fdecay", "[", 
                    RowBox[{
                    "j", ",", "lst", ",", "i", ",", "lsk", ",", "stages"}], 
                    "]"}]}]}], "]"}]}], ";"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "adding", " ", "a", " ", "point", " ", "for", " ", "ploting"}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"output", ",", "lst"}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"*", "non", " ", "sequestered", " ", "parasites"}], 
           "**)"}], "\[IndentingNewLine]", 
          RowBox[{"junk", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"LsDot", "[", 
              RowBox[{"#", ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"PRingFunc", "[", 
                  RowBox[{"i", ",", "11", ",", "14"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "hours"}], "}"}]}], "]"}]}], 
              "]"}], "&"}], "/@", "output"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"onlyring", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", 
               RowBox[{"Log10", "[", 
                RowBox[{
                 RowBox[{"junk", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "//", "Total"}], "]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "junk", "]"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "total", " ", "of", " ", "parasites", " ", "over", " ", "time"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"tot", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", 
               RowBox[{"Log10", "@", 
                RowBox[{"Total", "[", 
                 RowBox[{"output", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "output", "]"}]}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"onlyring", ",", "tot"}], "}"}]}]}], "\[IndentingNewLine]",
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ParaDist", "[", 
        RowBox[{"initN_", ",", "LC_", ",", "mu_", ",", "sigma_"}], "]"}], ":=",
        "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"Log10", "@", 
          RowBox[{"DistributeN", "[", 
           RowBox[{"initN", ",", "LC", ",", "mu", ",", "sigma"}], "]"}]}], 
         ",", 
         RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
         RowBox[{"Frame", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}],
          ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<age of parasites (h)\>\"", ",", 
            "\"\<number of parasites\>\""}], "}"}]}], ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "13"}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "380"}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", "Black", "]"}]}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", "\"\<Parasite Age Distribution\>\""}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
         RowBox[{"FillingStyle", "\[Rule]", "Gray"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DHAGraph", "[", 
        RowBox[{"xm_", ",", "ym_", ",", "a_", ",", "ke_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"points", ",", "t"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"points", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"t", ",", 
               RowBox[{"genpoints", "[", 
                RowBox[{"xm", ",", "ym", ",", "ke", ",", "t"}], "]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "0", ",", "20", ",", "0.1"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"points", ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
            RowBox[{"Frame", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"True", ",", "True", ",", "False", ",", "False"}], 
              "}"}]}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<time (h)\>\"", ",", "\"\<DHA concentration (ng/ml)\>\""}], 
              "}"}]}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Black", ",", "Thick"}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "380"}], ",", 
            RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}], ",", " ", 
            RowBox[{"PlotLabel", "\[Rule]", "\"\<DHA Concentration\>\""}]}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ParaGraph", "[", 
        RowBox[{
        "initN_", ",", "PMR_Integer", ",", "mu_", ",", "sigma_", ",", 
         "hours_Integer", ",", "KZ_List", ",", "concdat_List", ",", 
         "everyH_Integer", ",", "Ndrug_Integer", ",", "gamma_List", ",", 
         "ec50_List", ",", "emin_List", ",", "emax_List", ",", "T_Real", ",", 
         "runMax_Integer"}], "]"}], ":=", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"ParasiteDynamics", "[", 
          RowBox[{
          "initN", ",", "PMR", ",", "mu", ",", "sigma", ",", "hours", ",", 
           "KZ", ",", "concdat", ",", "everyH", ",", "Ndrug", ",", "gamma", 
           ",", "ec50", ",", "emin", ",", "emax", ",", "T", ",", "runMax"}], 
          "]"}], ",", 
         RowBox[{"Frame", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<time (h)\>\"", ",", "\"\<# of parasites (log 10)\>\""}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Joined", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"True", ",", "True"}], "}"}]}], ",", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Black", ",", "Thick"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Gray", ",", "Thick", ",", "Dashed"}], "}"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "125"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "13"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"LineLegend", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Circulating\>\"", ",", "\"\<Circulating+Sequestered\>\""}],
               "}"}], "]"}], ",", "Below"}], "]"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "380"}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", "Black", "]"}]}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", "\"\<Parasite Clearance Profile\>\""}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.521814610463867*^9, 3.521814633495117*^9}, 
   3.521814721448242*^9, {3.521815588508789*^9, 3.521815589836914*^9}, {
   3.521815741586914*^9, 3.521815761633789*^9}, {3.521815913774414*^9, 
   3.521815978133789*^9}, {3.521816008180664*^9, 3.521816016352539*^9}, {
   3.521816060383789*^9, 3.521816060899414*^9}, {3.521816140524414*^9, 
   3.521816237196289*^9}, {3.5218168158847656`*^9, 3.5218168756503906`*^9}, {
   3.5218170158847656`*^9, 3.5218170206191406`*^9}, {3.521850502575093*^9, 
   3.521850506629501*^9}, 3.5218506204837623`*^9, {3.5218507676864147`*^9, 
   3.5218508184888077`*^9}, 3.521851156368944*^9, {3.521851248818699*^9, 
   3.521851255690135*^9}, 3.521851394274506*^9, 3.5218517906271124`*^9, {
   3.5218519341644073`*^9, 3.5218519447307663`*^9}, 3.5218520313967266`*^9, {
   3.5218521190756865`*^9, 3.521852141252572*^9}, {3.521852521568799*^9, 
   3.521852535902359*^9}, {3.5218535908153267`*^9, 3.5218535915181456`*^9}, 
   3.521853655802657*^9, {3.5218538521634035`*^9, 3.5218539061423216`*^9}, {
   3.521853939113819*^9, 3.5218539547171*^9}, {3.5218551393539295`*^9, 
   3.5218551757937613`*^9}, {3.5218559840219355`*^9, 3.52185599298816*^9}, {
   3.5218580506908875`*^9, 3.5218580623863554`*^9}, {3.521858957745637*^9, 
   3.521858958104986*^9}, {3.5218590585354156`*^9, 3.5218590932162485`*^9}, {
   3.5218592290460606`*^9, 3.521859232123516*^9}, {3.5218592874396014`*^9, 
   3.5218592901733813`*^9}, {3.5218593790439167`*^9, 
   3.5218594350601053`*^9}, {3.521859506462782*^9, 3.5218595101805325`*^9}, {
   3.521859714733941*^9, 3.5218597459749413`*^9}, {3.5218599696163044`*^9, 
   3.5218599726799607`*^9}, {3.5218600796265783`*^9, 
   3.5218600838625526`*^9}, {3.5218602082584233`*^9, 
   3.5218602317581224`*^9}, {3.521860266507678*^9, 3.52186027182011*^9}, {
   3.5218603313818474`*^9, 3.5218603529596963`*^9}, {3.5218604016934013`*^9, 
   3.5218604395154743`*^9}, {3.5218604785561013`*^9, 
   3.5218604947566338`*^9}, {3.5218618089121833`*^9, 
   3.5218618118021235`*^9}, {3.521861846309575*^9, 3.521861847434309*^9}, {
   3.5218666959314156`*^9, 3.5218667037122173`*^9}, {3.5218696842010365`*^9, 
   3.5218697139159822`*^9}, {3.5225885927290363`*^9, 
   3.5225886658270035`*^9}, {3.5225887689125414`*^9, 
   3.5225888025381775`*^9}, {3.522588855581661*^9, 3.5225889050967016`*^9}, 
   3.522588987805971*^9, {3.522589794074269*^9, 3.5225898349583673`*^9}, {
   3.522589911020091*^9, 3.5225900463248568`*^9}, {3.522590095907898*^9, 
   3.52259024471294*^9}, {3.522590454039917*^9, 3.522590512270667*^9}, {
   3.5225906305241957`*^9, 3.522590666987865*^9}, {3.5225907594716854`*^9, 
   3.5225907653793616`*^9}, {3.5225909433684807`*^9, 
   3.5225909554136376`*^9}, {3.5225909962575645`*^9, 3.522591299979309*^9}, {
   3.5225913499745607`*^9, 3.5225913565922456`*^9}, {3.52259151362926*^9, 
   3.522591550895005*^9}, {3.522591590435796*^9, 3.5225917661993113`*^9}, {
   3.522591810930206*^9, 3.52259181264524*^9}, {3.5225918771565304`*^9, 
   3.5225920535568085`*^9}, {3.5225921478662386`*^9, 3.522592160103462*^9}, {
   3.52259226979543*^9, 3.5225922708295336`*^9}, 3.522783581814267*^9, 
   3.522783707470009*^9, {3.522783740534132*^9, 3.522783761968639*^9}, {
   3.5227838196343107`*^9, 3.522783824017214*^9}, {3.522783875419714*^9, 
   3.522783918286809*^9}, {3.522783962304118*^9, 3.522783992159997*^9}, {
   3.5227840443010693`*^9, 3.522784066209971*^9}, {3.52278409700589*^9, 
   3.5227841175065527`*^9}, {3.5227841699222193`*^9, 3.5227841924338083`*^9}, 
   3.5231163564672813`*^9, {3.523193370198997*^9, 3.523193382878973*^9}, 
   3.523193435811648*^9, 3.5231935366959743`*^9, {3.5231938435344143`*^9, 
   3.523193863063923*^9}, 3.5231940525337553`*^9, {3.5864935126039333`*^9, 
   3.586493525068493*^9}, {3.586493561154256*^9, 3.5864935680027437`*^9}, {
   3.5864937356012955`*^9, 3.586493839207224*^9}, {3.5864939493964367`*^9, 
   3.5864940037032332`*^9}, {3.5864940497258234`*^9, 3.586494104297823*^9}, {
   3.5864941440652328`*^9, 3.5864943623819323`*^9}, {3.586494481977375*^9, 
   3.5864946250437093`*^9}, {3.5864946585373383`*^9, 3.586494703967621*^9}, {
   3.5866465159352922`*^9, 3.5866465772658577`*^9}, {3.5866466437115264`*^9, 
   3.5866466834147987`*^9}, {3.5866467559615173`*^9, 3.586646866876856*^9}, {
   3.700969208129009*^9, 3.7009692135691175`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`ctrl$$ = 1, $CellContext`ec50R$$ = 
    20.5, $CellContext`ec50S$$ = 20.5, $CellContext`ec50T$$ = 
    20.5, $CellContext`emaxR$$ = 99.99, $CellContext`emaxS$$ = 
    99.99, $CellContext`emaxT$$ = 99.99, $CellContext`everyH$$ = 
    24, $CellContext`initN$$ = 2.8*^11, $CellContext`ke$$ = 
    0.5, $CellContext`KZRB$$ = 6, $CellContext`KZRE$$ = 
    26, $CellContext`KZSE$$ = 44, $CellContext`KZTE$$ = 
    38, $CellContext`Ndrug$$ = 7, $CellContext`PMR$$ = 7, $CellContext`T$$ = 
    5., $CellContext`xm$$ = 2, $CellContext`ym$$ = 
    1000, $CellContext`\[Gamma]R$$ = 6.5, $CellContext`\[Gamma]S$$ = 
    6.5, $CellContext`\[Gamma]T$$ = 6.5, $CellContext`\[Mu]$$ = 
    10, $CellContext`\[Sigma]$$ = 4, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Style["Mahidol-Oxford Tropical Medicine Research Unit", Bold]], 
      Manipulate`Dump`ThisIsNotAControl}, {
      Hold[
       Style["Saralamba S. et al. PNAS (2011) vol.108 no.1 397-402", Small]], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`ctrl$$], 1, ""}, {
      1 -> "parasite distribution", 2 -> "dose regimen", 3 -> 
       "DHA concentration", 4 -> "kill zones", 5 -> "killing effect"}}, {{
       Hold[$CellContext`initN$$], 2.8*^11, ""}, 1.*^11, 1000000000000, 
      5.*^10}, {{
       Hold[$CellContext`PMR$$], 7, ""}, 6, 32, 1}, {{
       Hold[$CellContext`\[Mu]$$], 10, ""}, 1, 48, 1}, {{
       Hold[$CellContext`\[Sigma]$$], 4, ""}, 1, 50, 1}, {{
       Hold[$CellContext`Ndrug$$], 7, ""}, 1, 24, 1}, {{
       Hold[$CellContext`everyH$$], 24, ""}, 1, 48, 1}, {{
       Hold[$CellContext`xm$$], 2, ""}, 1, 20}, {{
       Hold[$CellContext`ym$$], 1000, ""}, 0.5, 2000.}, {{
       Hold[$CellContext`ke$$], 0.5, ""}, 0.001, 10}, {{
       Hold[$CellContext`KZRB$$], 6, ""}, 1, 96, 1}, {{
       Hold[$CellContext`KZRE$$], 26, ""}, 
      Dynamic[$CellContext`KZRB$$], 60, 1}, {{
       Hold[$CellContext`KZTE$$], 38, ""}, 
      Dynamic[$CellContext`KZRE$$ + 1], 90, 1}, {{
       Hold[$CellContext`KZSE$$], 44, ""}, 
      Dynamic[$CellContext`KZTE$$ + 1], 100, 1}, {{
       Hold[$CellContext`\[Gamma]R$$], 6.5}, 0.5, 10, 0.001}, {{
       Hold[$CellContext`\[Gamma]T$$], 6.5}, 0.5, 10, 0.001}, {{
       Hold[$CellContext`\[Gamma]S$$], 6.5}, 0.5, 10, 0.001}, {{
       Hold[$CellContext`ec50R$$], 20.5, ""}, 0.001, 100, 0.001}, {{
       Hold[$CellContext`ec50T$$], 20.5, ""}, 0.001, 100, 0.001}, {{
       Hold[$CellContext`ec50S$$], 20.5, ""}, 0.001, 100, 0.001}, {{
       Hold[$CellContext`emaxR$$], 99.99, ""}, 50, 99.999, 0.001}, {{
       Hold[$CellContext`emaxT$$], 99.99, ""}, 50, 99.999, 0.001}, {{
       Hold[$CellContext`emaxS$$], 99.99, ""}, 50, 99.999, 0.001}, {{
       Hold[$CellContext`T$$], 5., ""}, 1., 10., 0.001}, {
      Hold[
       PaneSelector[{1 -> Column[{
            Style["Parasite distribution on admission", Bold], 
            "initial number of parasites", 
            Manipulate`Place[1], "parasite multiplication rate (/48 hours)", 
            Manipulate`Place[2], "mean age of parasite (hours)", 
            Manipulate`Place[3], 
            "standard deviation of parasite ages (hours)", 
            Manipulate`Place[4]}], 2 -> Column[{
            Style["Dose regimen", Bold], "number of doses", 
            Manipulate`Place[5], "dosing interval (hours)", 
            Manipulate`Place[6]}], 3 -> Column[{
            Style["DHA concentration profile (for each dose)", Bold], 
            "time at max concentration (hours)", 
            Manipulate`Place[7], "max concentration (ng/ml)", 
            Manipulate`Place[8], "elimination rate (/hours)", 
            Manipulate`Place[9]}], 4 -> Column[{
            Style["Kill zones (sensitive ages) ", Bold], 
            "ring: begin kill zone (hours)", 
            Manipulate`Place[10], "ring: end kill zone (hours)", 
            Manipulate`Place[11], "trophozoite: end kill zone (hours)", 
            Manipulate`Place[12], "schizont: end kill zone (hours)", 
            Manipulate`Place[13]}], 5 -> Column[{
            Style["Killing effect parameters", Bold], 
            Manipulate`Place[14], 
            Manipulate`Place[15], 
            Manipulate`Place[16], "EC50 ring (ng/ml)", 
            Manipulate`Place[17], "EC50 trophozoites (ng/ml)", 
            Manipulate`Place[18], "EC50 schizont (ng/ml)", 
            Manipulate`Place[19], "ring: max efficacy (%)", 
            Manipulate`Place[20], "trophozoite: max efficacy (%)", 
            Manipulate`Place[21], "schizont: max efficacy (%)", 
            Manipulate`Place[22], "1/alpha", 
            Manipulate`Place[23]}]}, 
        Dynamic[$CellContext`ctrl$$]]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = Automatic, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`ctrl$94068$$ = 
    False, $CellContext`initN$94069$$ = 0, $CellContext`PMR$94070$$ = 
    0, $CellContext`\[Mu]$94071$$ = 0, $CellContext`\[Sigma]$94072$$ = 
    0, $CellContext`Ndrug$94073$$ = 0, $CellContext`everyH$94074$$ = 
    0, $CellContext`xm$94075$$ = 0, $CellContext`ym$94076$$ = 
    0, $CellContext`ke$94077$$ = 0, $CellContext`KZRB$94078$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     2, StandardForm, 
      "Variables" :> {$CellContext`ctrl$$ = 1, $CellContext`ec50R$$ = 
        20.5, $CellContext`ec50S$$ = 20.5, $CellContext`ec50T$$ = 
        20.5, $CellContext`emaxR$$ = 99.99, $CellContext`emaxS$$ = 
        99.99, $CellContext`emaxT$$ = 99.99, $CellContext`everyH$$ = 
        24, $CellContext`initN$$ = 2.8*^11, $CellContext`ke$$ = 
        0.5, $CellContext`KZRB$$ = 6, $CellContext`KZRE$$ = 
        26, $CellContext`KZSE$$ = 44, $CellContext`KZTE$$ = 
        38, $CellContext`Ndrug$$ = 7, $CellContext`PMR$$ = 
        7, $CellContext`T$$ = 5., $CellContext`xm$$ = 2, $CellContext`ym$$ = 
        1000, $CellContext`\[Gamma]R$$ = 6.5, $CellContext`\[Gamma]S$$ = 
        6.5, $CellContext`\[Gamma]T$$ = 6.5, $CellContext`\[Mu]$$ = 
        10, $CellContext`\[Sigma]$$ = 4}, "ControllerVariables" :> {
        Hold[$CellContext`ctrl$$, $CellContext`ctrl$94068$$, False], 
        Hold[$CellContext`initN$$, $CellContext`initN$94069$$, 0], 
        Hold[$CellContext`PMR$$, $CellContext`PMR$94070$$, 0], 
        Hold[$CellContext`\[Mu]$$, $CellContext`\[Mu]$94071$$, 0], 
        Hold[$CellContext`\[Sigma]$$, $CellContext`\[Sigma]$94072$$, 0], 
        Hold[$CellContext`Ndrug$$, $CellContext`Ndrug$94073$$, 0], 
        Hold[$CellContext`everyH$$, $CellContext`everyH$94074$$, 0], 
        Hold[$CellContext`xm$$, $CellContext`xm$94075$$, 0], 
        Hold[$CellContext`ym$$, $CellContext`ym$94076$$, 0], 
        Hold[$CellContext`ke$$, $CellContext`ke$94077$$, 0], 
        Hold[$CellContext`KZRB$$, $CellContext`KZRB$94078$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Column[{
         $CellContext`ParaDist[$CellContext`initN$$, 
          48, $CellContext`\[Mu]$$, $CellContext`\[Sigma]$$], 
         $CellContext`DHAGraph[$CellContext`xm$$, $CellContext`ym$$, \
$CellContext`a, $CellContext`ke$$], 
         $CellContext`ParaGraph[$CellContext`initN$$, $CellContext`PMR$$, \
$CellContext`\[Mu]$$, $CellContext`\[Sigma]$$, 
          48, {{$CellContext`KZRB$$, $CellContext`KZRE$$}, \
{$CellContext`KZRE$$ + 1, $CellContext`KZTE$$}, {$CellContext`KZTE$$ + 
            
            1, $CellContext`KZSE$$}}, {$CellContext`xm$$, $CellContext`ym$$, \
$CellContext`a, $CellContext`ke$$}, $CellContext`everyH$$, \
$CellContext`Ndrug$$, {$CellContext`\[Gamma]R$$, $CellContext`\[Gamma]T$$, \
$CellContext`\[Gamma]S$$}, {$CellContext`ec50R$$, $CellContext`ec50T$$, \
$CellContext`ec50S$$}, {0., 0., 
          0.}, {$CellContext`emaxR$$, $CellContext`emaxT$$, \
$CellContext`emaxS$$}, $CellContext`T$$, 120]}, Frame -> All], 
      "Specifications" :> {
        Style["Mahidol-Oxford Tropical Medicine Research Unit", Bold], 
        Delimiter, 
        Style["Saralamba S. et al. PNAS (2011) vol.108 no.1 397-402", Small], 
        Delimiter, {{$CellContext`ctrl$$, 1, ""}, {
         1 -> "parasite distribution", 2 -> "dose regimen", 3 -> 
          "DHA concentration", 4 -> "kill zones", 5 -> "killing effect"}, 
         ControlPlacement -> Top}, {{$CellContext`initN$$, 2.8*^11, ""}, 
         1.*^11, 1000000000000, 5.*^10, Appearance -> "Labeled", ImageSize -> 
         Tiny, ControlPlacement -> 1}, {{$CellContext`PMR$$, 7, ""}, 6, 32, 1,
          Appearance -> "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         2}, {{$CellContext`\[Mu]$$, 10, ""}, 1, 48, 1, Appearance -> 
         "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         3}, {{$CellContext`\[Sigma]$$, 4, ""}, 1, 50, 1, Appearance -> 
         "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         4}, {{$CellContext`Ndrug$$, 7, ""}, 1, 24, 1, Appearance -> 
         "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         5}, {{$CellContext`everyH$$, 24, ""}, 1, 48, 1, Appearance -> 
         "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         6}, {{$CellContext`xm$$, 2, ""}, 1, 20, Appearance -> "Labeled", 
         ImageSize -> Tiny, ControlPlacement -> 
         7}, {{$CellContext`ym$$, 1000, ""}, 0.5, 2000., Appearance -> 
         "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         8}, {{$CellContext`ke$$, 0.5, ""}, 0.001, 10, Appearance -> 
         "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         9}, {{$CellContext`KZRB$$, 6, ""}, 1, 96, 1, Appearance -> "Labeled",
          ImageSize -> Tiny, ControlPlacement -> 
         10}, {{$CellContext`KZRE$$, 26, ""}, 
         Dynamic[$CellContext`KZRB$$], 60, 1, Appearance -> "Labeled", 
         ImageSize -> Tiny, ControlPlacement -> 
         11}, {{$CellContext`KZTE$$, 38, ""}, 
         Dynamic[$CellContext`KZRE$$ + 1], 90, 1, Appearance -> "Labeled", 
         ImageSize -> Tiny, ControlPlacement -> 
         12}, {{$CellContext`KZSE$$, 44, ""}, 
         Dynamic[$CellContext`KZTE$$ + 1], 100, 1, Appearance -> "Labeled", 
         ImageSize -> Tiny, ControlPlacement -> 
         13}, {{$CellContext`\[Gamma]R$$, 6.5}, 0.5, 10, 0.001, Appearance -> 
         "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         14}, {{$CellContext`\[Gamma]T$$, 6.5}, 0.5, 10, 0.001, Appearance -> 
         "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         15}, {{$CellContext`\[Gamma]S$$, 6.5}, 0.5, 10, 0.001, Appearance -> 
         "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         16}, {{$CellContext`ec50R$$, 20.5, ""}, 0.001, 100, 0.001, 
         Appearance -> "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         17}, {{$CellContext`ec50T$$, 20.5, ""}, 0.001, 100, 0.001, 
         Appearance -> "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         18}, {{$CellContext`ec50S$$, 20.5, ""}, 0.001, 100, 0.001, 
         Appearance -> "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         19}, {{$CellContext`emaxR$$, 99.99, ""}, 50, 99.999, 0.001, 
         Appearance -> "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         20}, {{$CellContext`emaxT$$, 99.99, ""}, 50, 99.999, 0.001, 
         Appearance -> "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         21}, {{$CellContext`emaxS$$, 99.99, ""}, 50, 99.999, 0.001, 
         Appearance -> "Labeled", ImageSize -> Tiny, ControlPlacement -> 
         22}, {{$CellContext`T$$, 5., ""}, 1., 10., 0.001, Appearance -> 
         "Labeled", ImageSize -> Tiny, ControlPlacement -> 23}, 
        PaneSelector[{1 -> Column[{
             Style["Parasite distribution on admission", Bold], 
             "initial number of parasites", 
             Manipulate`Place[1], "parasite multiplication rate (/48 hours)", 
             Manipulate`Place[2], "mean age of parasite (hours)", 
             Manipulate`Place[3], 
             "standard deviation of parasite ages (hours)", 
             Manipulate`Place[4]}], 2 -> Column[{
             Style["Dose regimen", Bold], "number of doses", 
             Manipulate`Place[5], "dosing interval (hours)", 
             Manipulate`Place[6]}], 3 -> Column[{
             Style["DHA concentration profile (for each dose)", Bold], 
             "time at max concentration (hours)", 
             Manipulate`Place[7], "max concentration (ng/ml)", 
             Manipulate`Place[8], "elimination rate (/hours)", 
             Manipulate`Place[9]}], 4 -> Column[{
             Style["Kill zones (sensitive ages) ", Bold], 
             "ring: begin kill zone (hours)", 
             Manipulate`Place[10], "ring: end kill zone (hours)", 
             Manipulate`Place[11], "trophozoite: end kill zone (hours)", 
             Manipulate`Place[12], "schizont: end kill zone (hours)", 
             Manipulate`Place[13]}], 5 -> Column[{
             Style["Killing effect parameters", Bold], 
             Manipulate`Place[14], 
             Manipulate`Place[15], 
             Manipulate`Place[16], "EC50 ring (ng/ml)", 
             Manipulate`Place[17], "EC50 trophozoites (ng/ml)", 
             Manipulate`Place[18], "EC50 schizont (ng/ml)", 
             Manipulate`Place[19], "ring: max efficacy (%)", 
             Manipulate`Place[20], "trophozoite: max efficacy (%)", 
             Manipulate`Place[21], "schizont: max efficacy (%)", 
             Manipulate`Place[22], "1/alpha", 
             Manipulate`Place[23]}]}, 
         Dynamic[$CellContext`ctrl$$]]}, 
      "Options" :> {
       ControlPlacement -> Left, SynchronousInitialization -> False, 
        ContinuousAction -> False, AutorunSequencing -> {1, 2}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{701., {460., 467.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`genpoints[
          Pattern[$CellContext`xm, 
           Blank[]], 
          Pattern[$CellContext`ym, 
           Blank[]], 
          Pattern[$CellContext`ke, 
           Blank[]], 
          Pattern[$CellContext`x, 
           Blank[]]] := 
        Piecewise[{{$CellContext`ym - ($CellContext`ym/$CellContext`xm) \
($CellContext`xm - $CellContext`x), $CellContext`x <= $CellContext`xm}, \
{$CellContext`ym 
            Exp[(-$CellContext`ke) ($CellContext`x - $CellContext`xm)], \
$CellContext`x > $CellContext`xm}}]; $CellContext`ConcMod[
          Pattern[$CellContext`xm, 
           Blank[]], 
          Pattern[$CellContext`ym, 
           Blank[]], 
          Pattern[$CellContext`a, 
           Blank[]], 
          Pattern[$CellContext`ke, 
           Blank[]], 
          Pattern[$CellContext`everyH, 
           Blank[Integer]], 
          Pattern[$CellContext`Ndrug, 
           Blank[Integer]], 
          Pattern[$CellContext`gamma, 
           Blank[List]], 
          Pattern[$CellContext`ec50, 
           Blank[List]], 
          Pattern[$CellContext`emin, 
           Blank[List]], 
          Pattern[$CellContext`emax, 
           Blank[List]]] := 
        Module[{$CellContext`i, $CellContext`j = 0, $CellContext`nd = 
           1, $CellContext`dat, $CellContext`maxpoint, $CellContext`part1, \
$CellContext`part2, $CellContext`fitke, $CellContext`modka, \
$CellContext`modke, $CellContext`fn, $CellContext`x, $CellContext`endtime, \
$CellContext`t, $CellContext`conc = 
           0, $CellContext`concls = {}, $CellContext`TIMEMAX = 1000}, 
          For[$CellContext`i = 
            0, $CellContext`i < $CellContext`Ndrug $CellContext`everyH, \
$CellContext`i = $CellContext`i + 1, 
            If[$CellContext`j != $CellContext`everyH, $CellContext`conc = 
               ReplaceAll[
                 $CellContext`genpoints[$CellContext`xm, $CellContext`ym, \
$CellContext`ke, $CellContext`x], $CellContext`x -> $CellContext`j]; 
              AppendTo[$CellContext`concls, {$CellContext`i, \
$CellContext`conc, 
                 $CellContext`Eff[$CellContext`conc, 
                  Part[$CellContext`gamma, 1], 
                  Part[$CellContext`ec50, 1], 
                  Part[$CellContext`emin, 1], 
                  Part[$CellContext`emax, 1]], 
                 $CellContext`Eff[$CellContext`conc, 
                  Part[$CellContext`gamma, 2], 
                  Part[$CellContext`ec50, 2], 
                  Part[$CellContext`emin, 2], 
                  Part[$CellContext`emax, 2]], 
                 $CellContext`Eff[$CellContext`conc, 
                  Part[$CellContext`gamma, 3], 
                  Part[$CellContext`ec50, 3], 
                  Part[$CellContext`emin, 3], 
                  Part[$CellContext`emax, 3]]}]; Null]; If[
              
              And[$CellContext`j == $CellContext`everyH, $CellContext`nd < \
$CellContext`Ndrug], $CellContext`nd = $CellContext`nd + 1; $CellContext`conc = 
               ReplaceAll[$CellContext`conc + \
$CellContext`genpoints[$CellContext`xm, $CellContext`ym, $CellContext`ke, \
$CellContext`x], $CellContext`x -> $CellContext`j]; 
              AppendTo[$CellContext`concls, {$CellContext`i, \
$CellContext`conc, 
                 $CellContext`Eff[$CellContext`conc, 
                  Part[$CellContext`gamma, 1], 
                  Part[$CellContext`ec50, 1], 
                  Part[$CellContext`emin, 1], 
                  Part[$CellContext`emax, 1]], 
                 $CellContext`Eff[$CellContext`conc, 
                  Part[$CellContext`gamma, 2], 
                  Part[$CellContext`ec50, 2], 
                  Part[$CellContext`emin, 2], 
                  Part[$CellContext`emax, 2]], 
                 $CellContext`Eff[$CellContext`conc, 
                  Part[$CellContext`gamma, 3], 
                  Part[$CellContext`ec50, 3], 
                  Part[$CellContext`emin, 3], 
                  Part[$CellContext`emax, 3]]}]; $CellContext`j = 0; 
              Null]; $CellContext`j = $CellContext`j + 1; Null]; 
          For[$CellContext`i = $CellContext`Ndrug $CellContext`everyH; \
$CellContext`j = $CellContext`everyH, $CellContext`i <= $CellContext`TIMEMAX, \
$CellContext`i = $CellContext`i + 1, $CellContext`conc = ReplaceAll[
               $CellContext`genpoints[$CellContext`xm, $CellContext`ym, \
$CellContext`ke, $CellContext`x], $CellContext`x -> $CellContext`j]; 
            AppendTo[$CellContext`concls, {$CellContext`i, $CellContext`conc, 
               $CellContext`Eff[$CellContext`conc, 
                Part[$CellContext`gamma, 1], 
                Part[$CellContext`ec50, 1], 
                Part[$CellContext`emin, 1], 
                Part[$CellContext`emax, 1]], 
               $CellContext`Eff[$CellContext`conc, 
                Part[$CellContext`gamma, 2], 
                Part[$CellContext`ec50, 2], 
                Part[$CellContext`emin, 2], 
                Part[$CellContext`emax, 2]], 
               $CellContext`Eff[$CellContext`conc, 
                Part[$CellContext`gamma, 3], 
                Part[$CellContext`ec50, 3], 
                Part[$CellContext`emin, 3], 
                
                Part[$CellContext`emax, 
                 3]]}]; $CellContext`j = $CellContext`j + 1; 
            Null]; $CellContext`concls]; $CellContext`DistributeN[
          Pattern[$CellContext`initN, 
           Blank[]], 
          Pattern[$CellContext`LC, 
           Blank[Integer]], 
          Pattern[$CellContext`mu, 
           Blank[]], 
          Pattern[$CellContext`sigma, 
           Blank[]]] := 
        Module[{$CellContext`distr, $CellContext`x}, $CellContext`distr = 
           Table[
             N[
              PDF[
               
               NormalDistribution[$CellContext`mu, $CellContext`sigma], \
$CellContext`x]], {$CellContext`x, 1, $CellContext`LC}]; ($CellContext`initN/
            Total[$CellContext`distr]) $CellContext`distr]; \
$CellContext`Shiftonehour[
          Pattern[$CellContext`ls, 
           Blank[List]], 
          Pattern[$CellContext`PMR, 
           Blank[Integer]]] := 
        Module[{$CellContext`tmp}, $CellContext`tmp = $CellContext`ls; \
$CellContext`tmp = RotateRight[$CellContext`tmp]; $CellContext`tmp = 
           ReplacePart[$CellContext`tmp, 1 -> 
             Part[$CellContext`tmp, 
                1] $CellContext`PMR]; $CellContext`tmp]; $CellContext`Eff[
          Pattern[$CellContext`c, 
           Blank[]], 
          Pattern[$CellContext`gamma, 
           Blank[]], 
          Pattern[$CellContext`ec50, 
           Blank[]], 
          Pattern[$CellContext`emin, 
           Blank[]], 
          Pattern[$CellContext`emax, 
           
           Blank[]]] := $CellContext`emin + ($CellContext`emax - \
$CellContext`emin) \
($CellContext`c^$CellContext`gamma/($CellContext`c^$CellContext`gamma + \
$CellContext`ec50^$CellContext`gamma)); $CellContext`Ki[
          Pattern[$CellContext`T, 
           Blank[Real]], 
          Pattern[$CellContext`concls, 
           Blank[List]]] := 
        Module[{$CellContext`i, $CellContext`lsk}, $CellContext`lsk = 
           Table[{(1/$CellContext`T) 
              Log[100./(100. - 
                Part[$CellContext`concls, $CellContext`i, 3])], (
               1/$CellContext`T) 
              Log[100./(100. - 
                Part[$CellContext`concls, $CellContext`i, 4])], (
               1/$CellContext`T) 
              Log[100./(100. - 
                Part[$CellContext`concls, $CellContext`i, 
                 5])]}, {$CellContext`i, 1, 
              
              Length[$CellContext`concls]}]; $CellContext`lsk]; \
$CellContext`Fdecay[
          Pattern[$CellContext`ages, 
           Blank[]], 
          Pattern[$CellContext`lst, 
           Blank[]], 
          Pattern[$CellContext`attime, 
           Blank[]], 
          Pattern[$CellContext`lsk, 
           Blank[]], 
          Pattern[$CellContext`stages, 
           Blank[]]] := 
        Module[{$CellContext`tmp, $CellContext`i}, $CellContext`i = \
$CellContext`ages; $CellContext`tmp = Part[$CellContext`lst, $CellContext`i]; 
          If[Part[$CellContext`stages, $CellContext`i] == 1, $CellContext`tmp = 
            Part[$CellContext`lst, $CellContext`i] 
             Exp[-Part[$CellContext`lsk, $CellContext`attime, 1]]]; 
          If[Part[$CellContext`stages, $CellContext`i] == 2, $CellContext`tmp = 
            Part[$CellContext`lst, $CellContext`i] 
             Exp[-Part[$CellContext`lsk, $CellContext`attime, 2]]]; 
          If[Part[$CellContext`stages, $CellContext`i] == 3, $CellContext`tmp = 
            Part[$CellContext`lst, $CellContext`i] 
             Exp[-Part[$CellContext`lsk, $CellContext`attime, 
                 3]]]; $CellContext`tmp]; $CellContext`WhichRTS[
          Pattern[$CellContext`lst, 
           Blank[List]], 
          Pattern[$CellContext`KZ, 
           Blank[List]]] := 
        Module[{$CellContext`i, $CellContext`tmp}, $CellContext`tmp = 
           Table[0, {
              Length[$CellContext`lst]}]; 
          For[$CellContext`i = 1, $CellContext`i <= 
            Length[$CellContext`lst], $CellContext`i = $CellContext`i + 1, 
            If[IntervalMemberQ[
                Interval[
                 Part[$CellContext`KZ, 1]], $CellContext`i] == 
              True, $CellContext`tmp = 
               ReplacePart[$CellContext`tmp, $CellContext`i -> 1]; Null]; 
            If[IntervalMemberQ[
                Interval[
                 Part[$CellContext`KZ, 2]], $CellContext`i] == 
              True, $CellContext`tmp = 
               ReplacePart[$CellContext`tmp, $CellContext`i -> 2]; Null]; 
            If[IntervalMemberQ[
                Interval[
                 Part[$CellContext`KZ, 3]], $CellContext`i] == 
              True, $CellContext`tmp = 
               ReplacePart[$CellContext`tmp, $CellContext`i -> 3]; Null]; 
            Null]; $CellContext`tmp]; $CellContext`PRingFunc[
          Pattern[$CellContext`i, 
           Blank[Integer]], 
          Pattern[$CellContext`a1, 
           Blank[Integer]], 
          Pattern[$CellContext`a2, 
           Blank[Integer]]] := 
        Piecewise[{{1, $CellContext`i < $CellContext`a1}, {
            Exp[
            Log[0.5] (($CellContext`i - $CellContext`a1)/($CellContext`a2 - \
$CellContext`a1))], $CellContext`i >= $CellContext`a1}}]; $CellContext`LsDot[
          Pattern[$CellContext`ls1, 
           Blank[List]], 
          Pattern[$CellContext`ls2, 
           Blank[
           List]]] := $CellContext`ls1 $CellContext`ls2; \
$CellContext`ParasiteDynamics[
          Pattern[$CellContext`initN, 
           Blank[]], 
          Pattern[$CellContext`PMR, 
           Blank[Integer]], 
          Pattern[$CellContext`mu, 
           Blank[]], 
          Pattern[$CellContext`sigma, 
           Blank[]], 
          Pattern[$CellContext`hours, 
           Blank[Integer]], 
          Pattern[$CellContext`KZ, 
           Blank[List]], 
          Pattern[$CellContext`concdat, 
           Blank[List]], 
          Pattern[$CellContext`everyH, 
           Blank[Integer]], 
          Pattern[$CellContext`Ndrug, 
           Blank[Integer]], 
          Pattern[$CellContext`gamma, 
           Blank[List]], 
          Pattern[$CellContext`ec50, 
           Blank[List]], 
          Pattern[$CellContext`emin, 
           Blank[List]], 
          Pattern[$CellContext`emax, 
           Blank[List]], 
          Pattern[$CellContext`T, 
           Blank[Real]], 
          Pattern[$CellContext`runMax, 
           Blank[Integer]]] := 
        Module[{$CellContext`runs = 
           True, $CellContext`stages, $CellContext`concls, $CellContext`i, \
$CellContext`j, $CellContext`lst, $CellContext`lsk, $CellContext`output = {}, \
$CellContext`xm, $CellContext`ym, $CellContext`a, $CellContext`ke, \
$CellContext`junk, $CellContext`onlyring, $CellContext`tot}, $CellContext`xm = P\
art[$CellContext`concdat, 1]; $CellContext`ym = 
           Part[$CellContext`concdat, 2]; $CellContext`a = 
           Part[$CellContext`concdat, 3]; $CellContext`ke = 
           Part[$CellContext`concdat, 
             4]; $CellContext`concls = $CellContext`ConcMod[$CellContext`xm, \
$CellContext`ym, $CellContext`a, $CellContext`ke, $CellContext`everyH, \
$CellContext`Ndrug, $CellContext`gamma, $CellContext`ec50, $CellContext`emin, \
$CellContext`emax]; $CellContext`lsk = $CellContext`Ki[$CellContext`T, \
$CellContext`concls]; $CellContext`lst = \
$CellContext`DistributeN[$CellContext`initN, $CellContext`hours, \
$CellContext`mu, $CellContext`sigma]; $CellContext`stages = \
$CellContext`WhichRTS[$CellContext`lst, $CellContext`KZ]; 
          AppendTo[$CellContext`output, $CellContext`lst]; $CellContext`i = 0; 
          While[
            
            And[$CellContext`runs == 
             True, $CellContext`i < $CellContext`runMax], $CellContext`i = \
$CellContext`i + 
              1; $CellContext`lst = \
$CellContext`Shiftonehour[$CellContext`lst, $CellContext`PMR]; 
            For[$CellContext`j = 1, $CellContext`j <= 
              Length[$CellContext`lst], $CellContext`j = $CellContext`j + 
               1, $CellContext`lst = 
               ReplacePart[$CellContext`lst, $CellContext`j -> \
$CellContext`Fdecay[$CellContext`j, $CellContext`lst, $CellContext`i, \
$CellContext`lsk, $CellContext`stages]]; Null]; 
            AppendTo[$CellContext`output, $CellContext`lst]; 
            Null]; $CellContext`junk = Map[$CellContext`LsDot[#, 
              Table[
               $CellContext`PRingFunc[$CellContext`i, 11, 
                14], {$CellContext`i, 
                1, $CellContext`hours}]]& , $CellContext`output]; \
$CellContext`onlyring = Table[{$CellContext`i - 1, 
              Log10[
               Total[
                Part[$CellContext`junk, $CellContext`i]]]}, {$CellContext`i, 
              1, 
              Length[$CellContext`junk]}]; $CellContext`tot = 
           Table[{$CellContext`i - 1, 
              Log10[
               Total[
                Part[$CellContext`output, $CellContext`i]]]}, {$CellContext`i,
               1, 
              
              Length[$CellContext`output]}]; {$CellContext`onlyring, \
$CellContext`tot}]; $CellContext`ParaDist[
          Pattern[$CellContext`initN, 
           Blank[]], 
          Pattern[$CellContext`LC, 
           Blank[]], 
          Pattern[$CellContext`mu, 
           Blank[]], 
          Pattern[$CellContext`sigma, 
           Blank[]]] := ListPlot[
          Log10[
           $CellContext`DistributeN[$CellContext`initN, $CellContext`LC, \
$CellContext`mu, $CellContext`sigma]], Filling -> Axis, 
          Frame -> {True, True, False, False}, 
          FrameLabel -> {"age of parasites (h)", "number of parasites"}, 
          Joined -> True, PlotRange -> {0, 13}, ImageSize -> 380, LabelStyle -> 
          Directive[Black], PlotLabel -> "Parasite Age Distribution", 
          PlotStyle -> Black, FillingStyle -> Gray]; $CellContext`DHAGraph[
          Pattern[$CellContext`xm, 
           Blank[]], 
          Pattern[$CellContext`ym, 
           Blank[]], 
          Pattern[$CellContext`a, 
           Blank[]], 
          Pattern[$CellContext`ke, 
           Blank[]]] := 
        Module[{$CellContext`points, $CellContext`t}, $CellContext`points = 
           Table[{$CellContext`t, 
              $CellContext`genpoints[$CellContext`xm, $CellContext`ym, \
$CellContext`ke, $CellContext`t]}, {$CellContext`t, 0, 20, 0.1}]; 
          ListPlot[$CellContext`points, Joined -> True, PlotRange -> All, 
            Frame -> {True, True, False, False}, 
            FrameLabel -> {"time (h)", "DHA concentration (ng/ml)"}, 
            PlotStyle -> {Black, Thick}, ImageSize -> 380, LabelStyle -> 
            Directive[Black], PlotLabel -> 
            "DHA Concentration"]]; $CellContext`ParaGraph[
          Pattern[$CellContext`initN, 
           Blank[]], 
          Pattern[$CellContext`PMR, 
           Blank[Integer]], 
          Pattern[$CellContext`mu, 
           Blank[]], 
          Pattern[$CellContext`sigma, 
           Blank[]], 
          Pattern[$CellContext`hours, 
           Blank[Integer]], 
          Pattern[$CellContext`KZ, 
           Blank[List]], 
          Pattern[$CellContext`concdat, 
           Blank[List]], 
          Pattern[$CellContext`everyH, 
           Blank[Integer]], 
          Pattern[$CellContext`Ndrug, 
           Blank[Integer]], 
          Pattern[$CellContext`gamma, 
           Blank[List]], 
          Pattern[$CellContext`ec50, 
           Blank[List]], 
          Pattern[$CellContext`emin, 
           Blank[List]], 
          Pattern[$CellContext`emax, 
           Blank[List]], 
          Pattern[$CellContext`T, 
           Blank[Real]], 
          Pattern[$CellContext`runMax, 
           Blank[Integer]]] := ListPlot[
          $CellContext`ParasiteDynamics[$CellContext`initN, $CellContext`PMR, \
$CellContext`mu, $CellContext`sigma, $CellContext`hours, $CellContext`KZ, \
$CellContext`concdat, $CellContext`everyH, $CellContext`Ndrug, \
$CellContext`gamma, $CellContext`ec50, $CellContext`emin, $CellContext`emax, \
$CellContext`T, $CellContext`runMax], Frame -> {True, True, False, False}, 
          FrameLabel -> {"time (h)", "# of parasites (log 10)"}, 
          Joined -> {True, True}, 
          PlotStyle -> {{Black, Thick}, {Gray, Thick, Dashed}}, 
          PlotRange -> {{0, 125}, {0, 13}}, PlotLegends -> Placed[
            LineLegend[{"Circulating", "Circulating+Sequestered"}], Below], 
          ImageSize -> 380, LabelStyle -> Directive[Black], PlotLabel -> 
          "Parasite Clearance Profile"]}; Typeset`initDone$$ = True),
    SynchronousInitialization->False,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.5864941807881036`*^9, 3.586494215423048*^9, 3.5864942599485188`*^9, 
   3.5864943143645163`*^9, {3.5864943449565086`*^9, 3.5864943631357417`*^9}, 
   3.586494570843614*^9, 3.5864946017008095`*^9, {3.5864946452771683`*^9, 
   3.586494704981634*^9}, {3.5866466686255245`*^9, 3.5866466857548738`*^9}, 
   3.5866467716330194`*^9, 3.586646803865241*^9, {3.5866468453246403`*^9, 
   3.5866468692063007`*^9}, 3.7009692153991537`*^9}]
}, Open  ]]
},
WindowSize->{1221, 867},
WindowMargins->{{109, Automatic}, {Automatic, 87}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 53789, 1181, 3432, "Input"],
Cell[54371, 1205, 32555, 643, 977, "Output"]
}, Open  ]]
}
]
*)

